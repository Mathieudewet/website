#!/usr/bin/env node

const fileProcessor = require("./fileProcessor");
const { readFileSync, writeFile } = require("fs");
const { resolve } = require("path");
const jsyaml = require("js-yaml");

const loadedOutline = jsyaml.safeLoad(
  readFileSync(`${__dirname}/../config/outline.yaml`, "utf8"));

let yaml = "";

loadedOutline.map(directory => {
  directory.items.map((file) => {

    const fileTree = fileProcessor.processFile(directory.path, file.id);
    yaml += jsyaml.safeDump(fileTree, { lineWidth: 255 });
  });

});

writeFile(resolve(__dirname, "../src/pages/docs/nav.yml"), yaml,
  error => error && console.warn(error));
